<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper
  PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
  "https://mybatis.org/dtd/mybatis-3-mapper.dtd">
  
<!-- 호출하는 인터페이스 경로 작성 -->
<mapper namespace="com.gdu.myapp.mapper.UserMapper"> 
 
 <!-- 모든 USER 정보를 다 SELECT 해서 MAP으로 저장 -> 필요한 정보만 MAP 으로 꺼내서 쓰기 위함 
      => 단순히 로그인용 쿼리로만 사용하는 것이 아니고 다양하게 사용될 수 있는 쿼리문
      => id는 구체적으로 주기보다는 어디서든 사용되도록 두루두루명으로 작성하는게 좋음
 -->
 <select id="getUserByMap"
          parameterType="Map"
          resultType="UserDto">
    SELECT USER_NO, EMAIL, PW, NAME, GENDER, MOBILE, EVENT_AGREE, SIGNUP_KIND, PW_MODIFY_DT, SIGNUP_DT
      FROM USER_T
    <where>
      <if test="email!=null">EMAIL = #{email}</if>
      <if test="pw!=null">AND PW = #{pw}</if>
    </where> <!-- ********** 조건에 의해서 조건이 바뀐다면 WHERE을 태그로 작성  => WHERE 태그는 필요없는 조건은 빼줌 -->
 </select>



<insert id="insertAccesHistory"
        parameterType="Map">
    INSERT INTO ACCESS_HISTORY_T (
       ACCESS_HISTORY_NO
     , EMAIL
     , IP
     , SIGNIN_DT
     , SIGNOUT_DT               <!-- SIGNOUT_DT 는 UPDATE로 갱신 -->
    ) VALUES (
      ACCESS_HISTORY_SEQ.NEXTVAL
     , #{email}
     , #{ip}
     , CURRENT_DATE
     , NULL
    )

</insert>

<insert id="insertUser"
        parameterType="UserDto">
   
</insert>

 </mapper>